2022.11.04
	Added CMachinePropertyItemVM
		moves machine specific stuff out of CTreeViewItemVM
		simplifies adding context menu commands to the property group types
	Refactoring to end the checked/selected naming confusion
	Implemented context menu operations for all treeview item types in both main and manager
	Added copy left/right to manager treeview items
	Changed various instances of List<IPropertyState> to HashSet<IPropertyState>
		Doesn't seem to have broken anything so far.
	Machine Command menu now shows a placeholder if there are no slots with data.

2022.11.03
	Implemented context menu for machine properties in main treeview

2022.11.02
	Implemented text based filtering of properties in treeviews
	Implemented machine commands menu

2022.11.01
	Added Show combo to main an manager
		Show stored/empty/all properties in the treeviews
		Added various related properties

2022.10.30
	Implemented renaming slots via slot combos
		Just needed to set "IsTextSearchEnabled" to false to prevent ketpresses from changing the selected item.

2022.10.22
	Version 1.1

2022.10.21
	Fixed copying empty properties (erase in dest)
	Auto expand property groups with values on slot change
	Disable manager copy buttons when both panes show the same slot
	Improved treeview navigation
	Implemented keyboard control of treeview checkboxes
	Fixed "Selection follows slot" broken in last commit
	Fixed manager selection buttons, also broken in last commit
	Fixed incorrect text styles used for manager treeview items
	Added manager buttons to select stored properties
	Improved selection info
	Disabled text input for slot name combo
		The "jump to letter" behaviour changes the active slot as you're typing.
		Need to find a way to disable it.
	Implemented display of parameter value descriptions

2022.10.20
	Added CMachineSnapshot.ClearSelected()
	Added manager buttons and matching commands for A/B operations
	Overhaul of various systems to facilitate operations on different slots
	Completed implementation of manager buttons

2022.10.19
	Implemented copy of empty properties (clear in dest)

2022.10.17
	Fixed incorrect tree structure for track params
	More work on displaying property values
	Implemented copying property values between slots
		Had to restructure quite a bit of stuff to get this working

2022.10.12
	Buttons for manager selection operations
	Started work on displaying property values

2022.10.11
	XAML improvements
		Various treeview/combobox styles and data templates converted to usercontrol resources

2022.10.10
	Manager A/B panes now showing correct state
	Synchronised IsChecked for A/B panes
		Replaced IsCheckedA and IsCheckedB with IsCheckedM

2022.10.06
	Changed constructor arguments for VM objects so everything has a reference to the main CSnapshotMachineVM
	Implemented GotValueA/GotValueB

2022.09.16
	Rethinking how the manager treeviews will work.
		We only have one collection of CMachineStateVM and all three treviews bind to that.
		Still need to work out how to implement separate data sources for the GotValue property
			Worst case we would have to add GotValueA and GotValueB but hopefully we can think of something more elegant.

2022.02.24
	Split ViewModel.cs into separate files. Got tired of scrolling.
	Added CTreeViewVM._stateVM
		Bit ugly but couldn't find a better way to allow tree items to query the reference for GotValue.
	Manager A/B panes work now

2022.02.21
	Reorganised stuff so things are no longer tied to a specific VM

2022.02.20
	Preliminary work on snapshot manager. Branched off due to extreme dodginess.
	Removed CMachineState.VM
		Multiple views are now tied to the same state so this reference to a single VM is no longer useful
	Added members to CSnapshotMachineVM to display list of machines in the two panels of the manager


2022.02.03
	Fixed error due to mismatch between snapshot clear and delegate.

2021.09.23
	Handle machine name/track changes

2021.09.21
	Update machine size info when GUI becomes active
	Display both stored and current data size for data states
	Removed redundant property Size from CPropertyStateVM

2021.09.20
	Prevent confirm on clear prompt during capture

2021.09.19
	Tooltips for most UI buttons
	Added option "Confirm on clear/purge"
	Prevent saving states for deleted machines
	Mapping dialog controls enable/disabled according to selected value in message type combo.
	Possible fix for wde crash report

2021.09.18
	Support for delete/undelete of machines
	Various tweaks
	Added postbuild script. Need to tweak it a bit for 'Any CPU' but it'll do for now.
	Added option 'Selection follows slot'
		On slot change, stored properties are selected while those which aren't are deselected.
	Added buttons for manipulating selection

2021.09.17
	Various UI improvements
		Removed CMidiEvent.MessageType because C# enums are a massive pain in the arse.
	Fixed loading for track params
		Added DisplayName property so params are saved with their correct name rather than the track number

2021.09.16
	Implemented MIDI learn.

2021.09.15
	Implemented core of MIDI mapping system
		MidiMap links Actions to MIDI event settings for UI interaction
		_midiMapping is used to fire Actions in response to actual MIDI events
		Save/load done.
		Implemented MidiNote and MidiControlChange
		Improved code generation for MIDI stuff including note-off handling (packing values with bitwise ops)
		Added MappingDialog
			<ctrl> Right-click on a button (Capture, Restore etc.) to launch
				Holding control signals that the mapping is for a snapshot command

2021.09.13
	Fixed more broken stuff.
	Implemented save/load
		Seems to work but needs more testing

2021.09.12
	Fixing stuff that was broken

2021.09.11
	Complete overhaul. Possibly a bad idea.
		Stored values are now held in a CMachineSnapshot rather than the individual properties
		Quite broken, work in progress.

2021.09.11
	Slot names in combo appear bold if slot has data

2021.09.10
	Implemented save/load to song
	Slot param now follows combo
	Fixed RestoreOnSongLoad
	Prevented auto capture/restore when slot changes due to song load

2021.09.09
	Restore on slot change working
		Added class MachineSnapshot so we can pass all changes to Buzz in one call
			This makes various Restore() methods obsolete but keeping them around in case we go back.

2021.09.07
	Added slot names

2021.09.05
	Treeview items bold when value stored
		Improved GotState for the container types
		Possibly added unnecessary events while floundering around trying to fix treeview update
	Tidying up of inherited stuff
	Fixed Slot off-by-one error 
	Added size data to the information display
		Added various Size and TotalSize properties
		Moved ToSize() method into a new class so we can use it more generally

2021.09.04
	Improved GUI control size stretch/fit etc.
	Removed MachineState.InputStates
		Apparently machine input parameters (amp + pan) can't be set
	Attribute now shown in treeview (duh)
	Fixed a few bugs related to Purge
	Implemented display of machine data size
	Data item is no longer added if machine has no data
	Fixed MachineState being needlessly generated for Snapshot
	Prevent items with no children being checked in UpdateTreeCheck()
	Implemented SelectNewMachines and RestoreOnStop
	Added base class PropertyBase to reduce some of the code duplication
	Started trying to implement slots

2021.09.03
	Implemented Capture, CaptureMissing, Restore, Clear and Purge 

2021.09.02
	Reworked things to handle machine data the same as params and attributes

2021.09.01
	Snapshot no longer appears in the treeview
	Added OnCheckChanged() to update state objects
	Machines default to unchecked
	Ignore params without state flag
	Made things more Interfacey and Eventy
	Track params are now selectable per track.
	Implemented info display

2021.09.30
	Overhaul of treeview related stuff
	Treeview checkboxes working properly although they don't actually do anything yet
		Need to figure out how to connect the state objects. Might need another overhaul :(

2021.09.12
	Getting things going. Starting to look like something that might eventually work.
	Trying to work out save/load